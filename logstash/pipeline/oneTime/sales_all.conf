input {
  tcp {
    port => 4000
}

    jdbc {
    jdbc_driver_library => "/usr/share/logstash/config/mysql-connector-java-5.1.44-bin.jar"
    jdbc_driver_class => "com.mysql.jdbc.Driver"
    jdbc_connection_string => "jdbc:mysql://188.226.156.99:3306/allympiapass_testing_20180107?useCursorFetch=true"
    jdbc_user => "elk_user"
    jdbc_password => "elk$2017"
    type => 'sales'
    clean_run => false
    jdbc_paging_enabled => "true"
    jdbc_page_size => 1000
    statement => "SELECT id , order_number,user_id,membership_plan_id,voucher_id,amount,payment_method,status as order_status,created_at ,DATE_FORMAT(sales_orders.created_at, '%Y-%m-%d') AS date_sales  FROM sales_orders"
    codec => "json"

  }

}

filter {

 sleep {
    time => "6"   # Sleep 1 second
    every => 1000   # on every 10th event
  }
  }

output {
if [type]  == "sales" {
elasticsearch { 
hosts => ["elasticsearch:9200"]
index => "sales-%{date_sales}"
document_type => "order"
document_id => "%{id}"
user =>  elastic
password => changeme

 }
}
stdout { codec => rubydebug }


}


